import { extractArgTypes } from '@astrouxds/storybook-addon-docs-stencil'
import { Meta, Story, Canvas, ArgsTable } from '@storybook/addon-docs/blocks'
import { html, render } from 'lit-html'

<Meta
    title="Components/Modal"
    component="rux-modal"
    argTypes={extractArgTypes('rux-modal')}
    parameters={{
        actions: {
            handles: ['ruxmodalclosed rux-modal', 'ruxmodalopened rux-modal'],
        },
    }}
/>

# Modal

A Modal interrupts the app experience to prompt a user to confirm an action or acknowledge a piece of information. `<rux-modal>` can be passed props for title and message, named slots, or a combination
of both.

## Guidelines

-   [Astro UXDS: Modal](https://astrouxds.com/ui-components/dialog-box)

export const Modal = (args) => {
    return html`
            <style>
            .sbdocs #story--components-modal--with-props {
                display: block;
                min-height: 500px;
            }
            rux-modal::part(modal-wrapper) {
                position: absolute;
                top: 0px;
                left: 0px;
                width: 100%;
                height: 100%;
            }
        </style>
        <div style="display: flex; flex-flow: column; justify-content: center;">
            <rux-modal
                ?open="${args.open}"
                modal-message="${args.modalMessage}"
                modal-title="${args.modalTitle}"
                confirm-text="${args.confirmText}"
                deny-text="${args.denyText}"
            ></rux-modal>
        </div
    `
}

<Canvas>
    <Story
        args={{
            open: true,
            modalMessage: 'Modal message',
            modalTitle: 'Modal title',
            confirmText: 'Release',
            denyText: 'Cancel',
        }}
        name="Modal"
    >
        {Modal.bind()}
    </Story>
</Canvas>

## API

<ArgsTable of="rux-modal" />

## Variants

### With Slots

export const WithSlots = (args) => {
    return html`
        <style>
            .sbdocs #story--components-modal--with-slots {
                display: block;
                min-height: 500px;
            }
            rux-modal::part(modal-wrapper) {
                position: absolute;
                top: 0px;
                left: 0px;
                width: 100%;
                height: 100%;
            }
        </style>
        <div style="display: flex; flex-flow: column; justify-content: center;">
            <rux-modal ?open="${args.open}" }>
                <div slot="header">Slot Title</div>
                <div slot="message">
                    <rux-input
                        placeholder="Modal Input"
                        label="Slotted Input"
                    ></rux-input>
                </div>
                <div
                    slot="footer"
                    style="
                        width: 100%;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    "
                >
                    <a
                        href="https://astrouxds.com/"
                        style="
                            margin-right: 10px;
                            text-decoration: none;
                            color: var(--color-primary);
                        "
                        >Slot Link</a
                    >
                    <rux-button-group>
                        <rux-button id="cancel-btn" secondary
                            >Cancel</rux-button
                        >
                        <rux-button id="confirm-btn">Confirm</rux-button>
                    </rux-button-group>
                </div>
            </rux-modal>
        </div>
    `
}

<Canvas>
    <Story
        args={{
            open: true,
        }}
        name="With Slots"
    >
        {WithSlots.bind()}
    </Story>
</Canvas>

### Close on click away

export const ClickToClose = (args) => {
    return html`
        <style>
            .sbdocs #story--components-modal--click-to-close {
                display: block;
                min-height: 500px;
            }
            rux-modal::part(modal-wrapper) {
                position: absolute;
                top: 0px;
                left: 0px;
                width: 100%;
                height: 100%;
            }
        </style>
        <div style="display: flex; flex-flow: column; justify-content: center;">
            <rux-modal
                ?open="${args.open}"
                ?click-to-close="${args.clickToClose}"
            >
                <div slot="header">Click Off Close</div>
                <div slot="message">
                    <p>
                        If click-to-close is true, clicking off of rux-modal
                        will close it.
                    </p>
                </div>
                <div
                    slot="footer"
                    style="width: 100%; display: flex; justify-content: space-between; align-items: center;"
                >
                    <div>
                        <a
                            href="https://astrouxds.com/"
                            style="margin-right: 10px; text-decoration: none; color: var(--color-primary);"
                            >Modal Link</a
                        >
                    </div>
                    <div>
                        <rux-button-group>
                            <rux-button secondary>Cancel</rux-button>
                            <rux-button>Confirm</rux-button>
                        </rux-button-group>
                    </div>
                </div>
            </rux-modal>
        </div>
    `
}

<Canvas>
    <Story
        args={{
            open: true,
            clickToClose: true,
        }}
        name="Click To Close"
    >
        {ClickToClose.bind()}
    </Story>
</Canvas>

## Opening, Closing and Focusing

These functions are handled by default if passing in props for `modal-message`. If slots are being used, a bit more boilerplate is required.

### Opening and Closing

The `open` prop of `rux-modal` is mutable and can be changed accordingly. Here is a basic example of doing so with buttons:

```js
<rux-modal id="modal" click-to-close>
    <div slot="header">Modal Header</div>
    <p>Modal Content here!</p>
    <div slot="footer">
        <rux-button id="confirm">Confirm</rux-button>
    </div>
</rux-modal>
<script>
    const modal = document.getElementById('modal');
    const confirm = document.getElementById('confirm')
    confirm.addEventListener('click', () => {
        modal.open = false;
    })
</script>
```

### Applying Focus

Often times when a modal opens, you want to autofocus a specific element. This is done by default by `rux-modal` if `modal-message` is passed in as props. If using slots, here's a quick way to do that
using the previous example:

```js
<rux-modal id="modal" click-to-close>
    <div slot="header">Modal Header</div>
    <p>Modal Content here!</p>
    <div slot="footer">
        <rux-button id="confirm">Confirm</rux-button>
    </div>
</rux-modal>
<script>
    const modal = document.getElementById('modal');
    const confirm = document.getElementById('confirm')
    modal.addEventListener('onruxmodalopened', () => {
        setTimout(() => {
            confirm.focus()
        }, 0)
    })
    confirm.addEventListener('click', () => {
        modal.open = false;
    })
</script>
```

## Cherry Picking

If you're already utilizing a build system that supports tree shaking and want to only import this individual component:

```js
import RuxModal from '@astrouxds/astro-web-components/dist/components/rux-modal.js'
import RuxButton from '@astrouxds/astro-web-components/dist/components/rux-button.js'
customElements.define('rux-modal', RuxModal)
customElements.define('rux-button', RuxButton)
```
